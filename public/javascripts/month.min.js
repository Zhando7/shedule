"use strict";console.log("Hello, admin"),document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".sidenav");M.Sidenav.init(e)});
"use strict";function MonthModule(){var e={errors:[],initXHR:function(e,t){if(t){var n=new XMLHttpRequest;return n.open(e,t,!0),n.setRequestHeader("Content-Type","application/json"),n}this.failure("","Ошибка запроса! Переданы не все аргументы.")},postRequest:function(e,t){if(e&&t){var n=this.initXHR("POST",e);n.addEventListener("load",function(){var e=JSON.parse(n.response);4==n.readyState&&200==n.status?this.prepareCreateMonth(e.docs):this.failure("Server error: ",e.msg)}.bind(this)),n.send(t)}},getRequest:function(e,t){if(e){var n=this.initXHR("GET",e);n.addEventListener("load",function(){var e=JSON.parse(n.response);4==n.readyState&&200==n.status?this.prepareGetDatesOfMonth(e.docs,t):this.failure("Server error: ",e.msg)}.bind(this)),n.send(null)}},deleteRequest:function(e,t){if(e&&t){var n=this.initXHR("DELETE",e);n.addEventListener("load",function(){var e=JSON.parse(n.response);4==n.readyState&&200==n.status?this.prepareDeleteMonth(t):this.failure("Server error:",e.msg)}.bind(this)),n.send(null)}},failure:function(e,t){this.errors.push(t),this.showDialog(e,t)},showDialog:function(e,t){e?console.log(e,t):M.toast({html:t})}},t={createMonth:function(){var e=document.querySelector("select"),t=document.getElementById("tableMonth").getAttribute("value"),n={number:e.selectedIndex,title:e.options[e.selectedIndex].label};if(1<=n.number&&n.number<=12){var s=JSON.stringify({id_year:t,month:n});this.postRequest("/admin/month",s)}else this.failure('Неправильное значение поля: "Выберите месяц"')},prepareCreateMonth:function(e){e&&(document.querySelector("select").selectedIndex=0,this.addRowToTable("tableMonth",e))},deleteMonth:function(e){if(e){var t="/admin/month/".concat(e);this.deleteRequest(t,e)}},prepareDeleteMonth:function(e){e&&(document.getElementById("tr__".concat(e)).remove(),document.getElementsByClassName("dates")[0].style.display="none")},getDatesOfMonth:function(e,t){if(e&&t){var n="/admin/dates/".concat(e);this.getRequest(n,t)}},prepareGetDatesOfMonth:function(e,t){e&&(document.getElementsByClassName("dates")[0].style.display="block",document.getElementById("nameMonth").innerHTML=t+" месяц",document.getElementById("tableDates").innerHTML=e)},addRowToTable:function(e,t){if(e&&t){var n=document.getElementById(e),s=n.insertRow(n.length),i=s.insertCell(0),o=s.insertCell(1),a=s.insertCell(2);s.setAttribute("id","tr__".concat(t._id)),i.setAttribute("class","hide-on-small-only"),o.setAttribute("onclick",'month.getDatesOfMonth("'.concat(t._id,'", "').concat(t.month.title,'")')),i.innerHTML="".concat(t._id),o.innerHTML="".concat(t.month.title),a.innerHTML="<a onclick=\"month.deleteMonth('".concat(t._id,'\')" class="waves-effect waves-light btn"><i class="small material-icons">delete</i></a>')}}};return Object.setPrototypeOf(t,e),t}var month=Object.create(MonthModule());document.getElementById("submitCreateMonth").addEventListener("click",function(e){e.preventDefault(),month.createMonth()});