"use strict";function checkValue(e){if(""==e)M.toast({html:'Заполните поле: "Введите год'});else{if(2020<=e&&e<=3e3)return!0;M.toast({html:'Неправильное значение поля: "Введите год"'})}return!1}function addRowToTable(e){var t=document.getElementById("tableYear"),n=t.insertRow(t.length),a=n.insertCell(0),o=n.insertCell(1),s=n.insertCell(2);n.setAttribute("id","tr__".concat(e._id)),a.setAttribute("class","hide-on-small-only"),o.setAttribute("id","td__".concat(e._id)),a.innerHTML="".concat(e._id),o.innerHTML='<a href="/admin/month/'.concat(e._id,'">').concat(e.year,"</a>"),s.innerHTML=getOperation(e)}function getOperation(e){var t=e._id,n=e.year;return"<a onclick=\"editSelectYear('".concat(t,"', '").concat(n,'\')" class="waves-effect waves-light btn"><i class="editLink small material-icons">edit</i></a>')+" "+"<a onclick=\"delSelectYear('".concat(t,'\')" class="removeLink waves-effect waves-light btn"><i class="small material-icons">delete</i></a>')}function delSelectYear(t){var e="/admin/year/".concat(t),n=new XMLHttpRequest;n.open("DELETE",e,!0),n.setRequestHeader("Content-Type","application/json"),n.addEventListener("load",function(){var e=JSON.parse(n.response);4==n.readyState&&200==n.status?document.getElementById("tr__".concat(t)).remove():console.log(e.msg)}),n.send(null)}function editSelectYear(e){var t="/admin/year/select/".concat(e),n=new XMLHttpRequest;n.open("GET",t,!0),n.setRequestHeader("Content-Type","application/json"),n.addEventListener("load",function(){var e=JSON.parse(n.response);if(4==n.readyState&&200==n.status){triggerForm(!0);var t=document.forms.editForm[0];document.forms.editForm.setAttribute("value",e.docs._id),t.value=e.docs.year}else console.log(e.msg)}),n.send(null)}function triggerForm(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,a=document.getElementsByClassName("__year"),o=document.getElementsByClassName("__year-edit");function s(e){for(var t=0;t<a.length;t++)a[t].style.display=e}switch(e){case!0:s("none"),o[0].style.display="block";break;case!1:o[0].style.display="none",s("block"),document.getElementById(t).innerHTML='<a href="/admin/month/'.concat(t,'">').concat(n,"</a>");break;default:o[0].style.display="none",s("block")}}console.log("Hello, admin"),document.getElementById("submitCreateYear").addEventListener("click",function(e){e.preventDefault();var t=document.forms.createForm,n=t.elements.year.value;if(checkValue(n)){var a=JSON.stringify({year:n}),o=new XMLHttpRequest;o.open("POST","/admin/year",!0),o.setRequestHeader("Content-Type","application/json"),o.addEventListener("load",function(){var e=JSON.parse(o.response);4==o.readyState&&200==o.status?(t.elements.year.value="",addRowToTable(e.docs)):console.log(e.msg)}),o.send(a)}}),document.getElementById("submitEditYear").addEventListener("click",function(e){e.preventDefault();var t=document.forms.editForm,n=t[0].value;if(checkValue(n)){var a=t.getAttribute("value"),o=JSON.stringify({_id:a,year:n}),s=new XMLHttpRequest;s.open("PUT","/admin/year",!0),s.setRequestHeader("Content-Type","application/json"),s.addEventListener("load",function(){var e=JSON.parse(s.response);4==s.readyState&&200==s.status?triggerForm(!1,"td__".concat(a),n):console.log(e.msg)}),s.send(o)}});