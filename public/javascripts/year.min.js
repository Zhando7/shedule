"use strict";console.log("Hello, admin"),document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".sidenav");M.Sidenav.init(e)});
"use strict";function YearModule(){var e={errors:[],initXHR:function(e,t){if(t){var r=new XMLHttpRequest;return r.open(e,t,!0),r.setRequestHeader("Content-Type","application/json"),r}this.failure("","Ошибка при передаче аргументов в initXHR()")},postRequest:function(e,t){if(e&&t){var r=this.initXHR("POST",e);r.addEventListener("load",function(){var e=JSON.parse(r.response);4==r.readyState&&200==r.status?this.prepareCreateYear(e.docs):this.failure("Server error: ",e.msg)}.bind(this)),r.send(t)}},getRequest:function(e){if(e){var t=this.initXHR("GET",e);t.addEventListener("load",function(){var e=JSON.parse(t.response);4==t.readyState&&200==t.status?this.prepareGetYear(e.docs):this.failure("Server error: ",e.msg)}.bind(this)),t.send(null)}},putRequest:function(e,t){if(e&&t){var r=this.initXHR("PUT",e);t=JSON.stringify(t),r.addEventListener("load",function(){var e=JSON.parse(r.response);4==r.readyState&&200==r.status?this.prepareEditYear(JSON.parse(t)):this.failure("Server error:",e.msg)}.bind(this)),r.send(t)}},deleteRequest:function(e,t){if(e){var r=this.initXHR("DELETE",e);r.addEventListener("load",function(){var e=JSON.parse(r.response);4==r.readyState&&200==r.status?this.prepareDeleteYear(t):this.failure("Server error: ",e.msg)}.bind(this)),r.send(null)}},failure:function(e,t){this.errors.push(t),this.showDialog(e,t)},showDialog:function(e,t){e?console.log(e,t):M.toast({html:t})}},t={getCreateFormValue:function(e){if(e)return document.forms[e].elements.year.value;this.failure("","Не найдена форма с указанным идентификатором!")},getEditFormValue:function(e){if(e){var t=document.forms[e];return{_id:t.getAttribute("attribIdYear"),year:t.getAttribute("attribYear")}}this.failure("","Не найдена форма с указанным идентификатором!")},clearInput:function(){var e;(e=document.forms.createForm)?e.elements.year.value="":this.failure("","Форма создания года не существует!")},createYear:function(){var e;if(e=this.getCreateFormValue("createForm"))if(e<2020||3e3<e)this.failure("","Ошибка! Пожалуйста, введите другой год!");else{var t=JSON.stringify({year:e});this.postRequest("/admin/year",t)}else this.failure("","Ошибка! Пожалуйста, введите год!")},prepareCreateYear:function(e){e?(this.clearInput(),this.addRowToTable("tableYear",e)):this.failure("Server error: ","Had not gotten data from server!")},getYear:function(e,t){if(e&&t){var r=document.forms.editForm;r.setAttribute("attribIdYear",e),r.setAttribute("attribYear",t),r[0].value=t,this.showEditForm(!0)}else this.failure("","Ошибка! Переданы не все аргументы.")},editYear:function(){var e;if(e=this.getEditFormValue("editForm")){var t=document.forms.editForm[0].value;if(t)if(t===e.year)this.showEditForm();else if(t<2020||3e3<t)this.failure("","Пожалуйста, введите другой год!");else{e.year=t;this.putRequest("/admin/year",e)}else this.failure("","Ошибка сохранения! Пожалуйста, укажите год!")}else this.failure("","Ошибка! Не удаётся найти необходимые аттрибуты.")},prepareEditYear:function(e){e?(document.getElementById("editBtn_".concat(e._id)).setAttribute("onclick","year.getYear('".concat(e._id,"', '").concat(e.year,"')")),this.showEditForm(!1,e._id,e.year)):this.failure("Server error: ","Had not gotten data from server!")},deleteYear:function(e){if(e){var t="/admin/year/".concat(e);this.deleteRequest(t,e)}else this.failure("","Идентификатор 'IdYear' не получен!")},prepareDeleteYear:function(e){e?document.getElementById("tr__".concat(e)).remove():this.failure("Server error: ","Идентификатор 'IdYear' не получен!")},addRowToTable:function(e,t){if(e&&t){var r=document.getElementById(e),i=r.insertRow(r.length),a=i.insertCell(0),n=i.insertCell(1),s=i.insertCell(2);i.setAttribute("id","tr__".concat(t._id)),a.setAttribute("class","hide-on-small-only"),n.setAttribute("id","td__".concat(t._id)),a.innerHTML="".concat(t._id),n.innerHTML='<a href="/admin/month/'.concat(t._id,'">').concat(t.year,"</a>"),s.innerHTML=this.initOperationsFields(t)}else this.failure("","Ошибка! Получены не все аргументы.")},initOperationsFields:function(e){if(e){var t=e._id,r=e.year;return'<a id="editBtn_'.concat(t,'" onclick="year.getYear(\'').concat(t,"', '").concat(r,'\')" class="waves-effect waves-light btn"><i class="editLink small material-icons">edit</i></a>')+" "+'<a id="deleteBtn_'.concat(t,'" onclick="year.deleteYear(\'').concat(t,'\')" class="removeLink waves-effect waves-light btn"><i class="small material-icons">delete</i></a>')}this.failure("","Ошибка! Получены не все аргументы.")},showEditForm:function(e,t,r){var i=1<arguments.length&&void 0!==t?t:void 0,a=2<arguments.length&&void 0!==r?r:void 0,n=document.getElementsByClassName("__year"),s=document.getElementsByClassName("__year-edit");function o(e){for(var t=0;t<n.length;t++)n[t].style.display=e}switch(e){case!0:o("none"),s[0].style.display="block";break;case!1:s[0].style.display="none",o("block"),document.getElementById("td__".concat(i)).innerHTML='<a href="/admin/month/'.concat(i,'">').concat(a,"</a>");break;default:s[0].style.display="none",o("block")}}};return Object.setPrototypeOf(t,e),t}var year=Object.create(YearModule());document.getElementById("submitCreateYear").addEventListener("click",function(e){e.preventDefault(),year.createYear()}),document.getElementById("submitEditYear").addEventListener("click",function(e){e.preventDefault(),year.editYear()});