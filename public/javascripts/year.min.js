"use strict";function checkValue(e){if(""==e)M.toast({html:'Заполните поле: "Введите год'});else{if(2020<=e&&e<=3e3)return!0;M.toast({html:'Неправильное значение поля: "Введите год"'})}return!1}function addRowToTable(e){var t=document.getElementById(e),n=t.insertRow(t.length),a=n.insertCell(0),s=n.insertCell(1),o=n.insertCell(2);n.setAttribute("id","tr__".concat(this._id)),a.setAttribute("class","hide-on-small-only"),s.setAttribute("id","td__".concat(this._id)),a.innerHTML="".concat(this._id),s.innerHTML='<a href="/admin/month/'.concat(this._id,'">').concat(this.year,"</a>"),o.innerHTML=getOperation.call(this)}function getOperation(){var e=this._id;return"<a onclick=\"editSelectYear('".concat(e,'\')" class="waves-effect waves-light btn"><i class="editLink small material-icons">edit</i></a>')+" "+"<a onclick=\"delSelectYear('".concat(e,'\')" class="removeLink waves-effect waves-light btn"><i class="small material-icons">delete</i></a>')}function delSelectYear(t){if(!t)return null;var e="/admin/year/".concat(t),n=new XMLHttpRequest;n.open("DELETE",e,!0),n.setRequestHeader("Content-Type","application/json"),n.addEventListener("load",function(){var e=JSON.parse(n.response);4==n.readyState&&200==n.status?document.getElementById("tr__".concat(t)).remove():console.log(e.msg)}),n.send(null)}function editSelectYear(e){if(!e)return null;var t="/admin/year/select/".concat(e),n=new XMLHttpRequest;n.open("GET",t,!0),n.setRequestHeader("Content-Type","application/json"),n.addEventListener("load",function(){var e=JSON.parse(n.response);if(4==n.readyState&&200==n.status){var t=document.forms.editForm[0];document.forms.editForm.setAttribute("value",e.docs._id),t.value=e.docs.year,triggerForm(!0)}else console.log(e.msg)}),n.send(null)}function triggerForm(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,a=document.getElementsByClassName("__year"),s=document.getElementsByClassName("__year-edit");function o(e){for(var t=0;t<a.length;t++)a[t].style.display=e}switch(e){case!0:o("none"),s[0].style.display="block";break;case!1:s[0].style.display="none",o("block"),document.getElementById("td__".concat(t)).innerHTML='<a href="/admin/month/'.concat(t,'">').concat(n,"</a>");break;default:s[0].style.display="none",o("block")}}console.log("Hello, admin"),document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".sidenav");M.Sidenav.init(e)}),document.getElementById("submitCreateYear").addEventListener("click",function(e){e.preventDefault();var t=document.forms.createForm,n=t.elements.year.value;if(checkValue(n)){var a=JSON.stringify({year:n}),s=new XMLHttpRequest;s.open("POST","/admin/year",!0),s.setRequestHeader("Content-Type","application/json"),s.addEventListener("load",function(){var e=JSON.parse(s.response);4==s.readyState&&200==s.status?(t.elements.year.value="",addRowToTable.call(e.docs,"tableYear")):console.log(e.msg)}),s.send(a)}}),document.getElementById("submitEditYear").addEventListener("click",function(e){e.preventDefault();var t=document.forms.editForm,n=t.getAttribute("value"),a=t[0].value;if(checkValue(a)){var s=JSON.stringify({_id:n,year:a}),o=new XMLHttpRequest;o.open("PUT","/admin/year",!0),o.setRequestHeader("Content-Type","application/json"),o.addEventListener("load",function(){var e=JSON.parse(o.response);4==o.readyState&&200==o.status?triggerForm(!1,n,a):console.log(e.msg)}),o.send(s)}});