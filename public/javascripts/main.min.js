"use strict";function AuthorizationModule(){var e={errors:[],getUser:function(){return document.forms.loginForm.elements.user_name.value},getPassword:function(){return document.forms.loginForm.elements.user_pass.value},validateEntry:function(e,t){return e=e||this.getUser(),t=t||this.getPassword(),e&&t?!(t.length<5)||this.failure("Ошибка авторизации! ","Пароль должен содержать больше 5 символов!"):this.failure("Ошибка авторизации! ","Пожалуйста, введите логин и пароль!")},failure:function(e,t){this.errors.push(t),this.showDialog(e,t)},showDialog:function(e,t){M.toast({html:e+t})}},t={checkAuth:function(){var e=this.getUser(),t=this.getPassword();if(this.validateEntry(e,t)){var s=JSON.stringify({name:e,password:t});this.server("/login",s)}},server:function(e,t){var s=new XMLHttpRequest;s.open("POST",e,!0),s.setRequestHeader("Content-Type","application/json"),s.addEventListener("load",function(){var e=JSON.parse(s.response);4==s.readyState&&200==s.status?this.accepted():this.failure("Ошибка аутентификации! ",e.msg)}.bind(this)),s.send(t)},accepted:function(){location.replace(document.baseURI+"admin"),this.showDialog("Аутентификация"," прошла успешно!")}};return Object.setPrototypeOf(t,e),t}var user=Object.create(AuthorizationModule());document.getElementById("submitLogin").addEventListener("click",function(e){e.preventDefault(),user.checkAuth()});
"use strict";function CalendarModule(){var t={errors:[],server:function(t,e){if(t&&e){var n=new XMLHttpRequest;n.open("GET",t,!0),n.setRequestHeader("Content-Type","application/json"),n.addEventListener("load",function(){var t=JSON.parse(n.response);4==n.readyState&&200==n.status?1===e?this.prepareRequestMonth(t.docs):2===e&&this.prepareRequestLessons(t.docs):this.failure("Server error: ",t.msg)}.bind(this)),n.send(null)}},failure:function(t,e){this.errors.push(e),this.showDialog(t,e)},showDialog:function(t,e){t?console.log(t,e):M.toast({html:e})}},e={init:function(t){t&&(this.idDomElement=t)},findSelectMonth:function(t,e){t&&e&&this.requestMonth(t,e)},requestMonth:function(t,e){if(t&&e){var n="/view/dates/".concat(e);this.idDomElement||this.init(t),this.server(n,1)}},prepareRequestMonth:function(t){0<t.length&&this.showCalendar(t)},showCalendar:function(t){if(0<t.length){document.getElementById("tableLessons").style.display="none";for(var e='<table class="striped centered"><thead><tr><th>пн</th><th>вт</th><th>ср</th><th>чт</th><th>пт</th><th>сб</th></tr></thead><tbody><tr>',n=new Date(t[0].full_date).getDay(),s=0,o=1;o<n;o++)e+="<td></td>";for(;s<t.length;)0!=new Date(t[s].full_date).getDay()&&(e+=this.initMonthCell(t,s)),6==new Date(t[s].full_date).getDay()&&s<t.length-1&&(e+="</tr><tr>"),s++;e+="</tr></tbody></table>",document.getElementById("".concat(this.idDomElement)).innerHTML=e,document.getElementById("".concat(this.idDomElement)).style.display="block"}},initMonthCell:function(t,e){if(0<t.length){var n='id="'.concat(t[e]._id,'"'),s="onclick=\"calendar.getLessons('".concat(t[e]._id,"')\""),o=new Date(t[e].full_date).getDate();return"<td ".concat(n," ").concat(s,">").concat(o,"</td>")}}},n={getLessons:function(t){t&&this.requestLessons(t)},requestLessons:function(t){if(t&&"string"==typeof t){var e="/view/lessons/".concat(t);this.server(e,2)}},prepareRequestLessons:function(t){0<t.length?this.showTableLessons(t):(document.getElementById("tableLessons").style.display="none",this.failure("","Уроков на эту дату не имеется"))},showTableLessons:function(t){if(0<t.length){for(var e=document.getElementById("tableLessons"),n='\n                        <table class="striped centered">\n                        <thead>\n                            <tr>\n                                <th>Время</th>\n                                <th>Название</th>\n                                <th>Описание</th>\n                            </tr>\n                        </thead>\n                        <tbody>  \n                    ',s=0;s<t.length;)n+="\n                        <tr>\n                            <td>".concat(t[s].time_start," - ").concat(t[s].time_end,"</td>\n                            <td>").concat(t[s].title,"</td>\n                            <td>").concat(t[s].desc,"</td>\n                        </tr>\n                    "),s++;e.style.display="block",e.innerHTML=n+"</tbody></table>"}}};return Object.setPrototypeOf(n,t),Object.setPrototypeOf(e,n),e}var calendar=Object.create(CalendarModule());
"use strict";document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".modal"),t=document.querySelectorAll(".sidenav");e&&t&&(M.Modal.init(e),M.Sidenav.init(t))});