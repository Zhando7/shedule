"use strict";function checkValue(e,t,n,s){var a=0;if(e?a++:M.toast({html:"Время начало урока не задано"}),t?a++:M.toast({html:"Время окончания урока не задано"}),n?a++:M.toast({html:"Название урока не задано"}),s?a++:M.toast({html:"Описание урока не задано"}),4==a&&3<=n.length&&3<=s.length)return!0}function clearCreateFormInputs(){var e=document.forms.createForm.querySelectorAll(".timepicker");e[0].value="",e[1].value="",document.getElementById("titleCreate").value="",document.getElementById("descCreate").value=""}function addRowToTable(){var e=document.getElementById("tableLesson"),t=e.insertRow(e.length),n=t.insertCell(0),s=t.insertCell(1),a=t.insertCell(2),i=t.insertCell(3);t.setAttribute("id","tr__".concat(this._id)),n.setAttribute("id","time__".concat(this._id)),s.setAttribute("id","title__".concat(this._id)),a.setAttribute("id","desc__".concat(this._id)),n.innerHTML="".concat(this.time_start," - ").concat(this.time_end),s.innerHTML=this.title,a.innerHTML=this.desc,i.innerHTML=getOperation.call(this)}function getOperation(){var e=this._id;return"<a onclick=\"editSelectLesson('".concat(e,'\')" class="waves-effect waves-light btn"><i class="editLink small material-icons">edit</i></a>')+" "+"<a onclick=\"delSelectLesson('".concat(e,'\')" class="waves-effect waves-light btn"><i class="small material-icons">delete</i></a>')}function delSelectLesson(t){var e="/admin/lesson/".concat(t),n=new XMLHttpRequest;n.open("DELETE",e,!0),n.setRequestHeader("Content-Type","application/json"),n.addEventListener("load",function(){var e=JSON.parse(n.response);4==n.readyState&&200==n.status?document.getElementById("tr__".concat(t)).remove():console.log(e.msg)}),n.send(null)}function editSelectLesson(e){var t="/admin/lesson/select/".concat(e),n=new XMLHttpRequest;n.open("GET",t,!0),n.setRequestHeader("Content-Type","application/json"),n.addEventListener("load",function(){var e=JSON.parse(n.response);4==n.readyState&&200==n.status?(triggerForm(!0),document.forms.editForm.setAttribute("value",e.docs._id)):console.log(e.msg)}),n.send(null)}function triggerForm(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,s=document.getElementsByClassName("__lesson"),a=document.getElementsByClassName("__lesson-edit");function i(e){for(var t=0;t<s.length;t++)s[t].style.display=e}switch(e){case!0:i("none"),a[0].style.display="block";break;case!1:a[0].style.display="none",i("block"),document.getElementById("time__".concat(t)).innerHTML=n.time_start+" - "+n.time_end,document.getElementById("title__".concat(t)).innerHTML=n.title,document.getElementById("desc__".concat(t)).innerHTML=n.desc;break;default:a[0].style.display="none",i("block")}}document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".sidenav");M.Sidenav.init(e)}),document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".timepicker");M.Timepicker.init(e)}),document.getElementById("submitCreateLesson").addEventListener("click",function(e){e.preventDefault();var t=document.forms.createForm.querySelectorAll(".timepicker"),n=t[0].value,s=t[1].value,a=document.getElementById("titleCreate").value,i=document.getElementById("descCreate").value;if(checkValue(n,s,a,i)){var l=document.getElementById("tableLesson").getAttribute("value"),o=new XMLHttpRequest,c=JSON.stringify({id_date:l,time_start:n,time_end:s,title:a,desc:i});o.open("POST","/admin/lesson",!0),o.setRequestHeader("Content-Type","application/json"),o.addEventListener("load",function(){var e=JSON.parse(o.response);4==o.readyState&&200==o.status?(clearCreateFormInputs(),addRowToTable.call(e.docs)):console.log(e.msg)}),o.send(c)}}),document.getElementById("submitEditLesson").addEventListener("click",function(e){e.preventDefault();var t=document.forms.editForm.querySelectorAll(".timepicker"),n=t[0].value,s=t[1].value,a=document.getElementById("titleEdit").value,i=document.getElementById("descEdit").value;if(checkValue(n,s,a,i)){var l=new XMLHttpRequest,o=document.forms.editForm.getAttribute("value"),c=JSON.stringify({_id:o,time_start:n,time_end:s,title:a,desc:i});l.open("PUT","/admin/lesson",!0),l.setRequestHeader("Content-Type","application/json"),l.addEventListener("load",function(){var e=JSON.parse(l.response);4==l.readyState&&200==l.status?triggerForm(!1,o,JSON.parse(c)):console.log(e.msg)}),l.send(c)}});